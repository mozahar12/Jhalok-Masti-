<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jhalok Masti - Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #000; font-family: sans-serif; }
        .app-container { height: 100vh; width: 100vw; position: relative; overflow: hidden; }
        video { width: 100%; height: 100%; object-fit: cover; background: #000; }
        
        /* স্টোরি সেকশন */
        .stories-bar {
            position: absolute; top: 40px; left: 0; width: 100%;
            display: flex; padding: 10px; overflow-x: auto; z-index: 30; gap: 12px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.7), transparent);
        }
        .story-circle { min-width: 65px; height: 65px; border-radius: 50%; border: 3px solid #f09433; padding: 2px; cursor: pointer; }
        .story-circle img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        
        #storyViewer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 100; display: none; align-items: center; justify-content: center;
        }
    </style>
</head>
<body>

<div class="app-container" id="swipeArea">
    <video id="mainVideo" playsinline loop src="VID_20251206_041026_071.mp4"></video>

    <div id="storyViewer" onclick="this.style.display='none'">
        <img id="viewingImg" src="" style="max-width: 90%; max-height: 80%;">
    </div>

    <div class="stories-bar" onclick="event.stopPropagation()">
        <label class="min-width-[65px] h-[65px] rounded-full bg-zinc-800 flex items-center justify-center border-2 border-dashed border-zinc-500 cursor-pointer p-6">
            <i class="fas fa-plus text-white"></i>
            <input type="file" accept="image/*" class="hidden" onchange="handleUpload(this)">
        </label>
        <div id="storyList" class="flex gap-3"></div>
    </div>

    <div class="absolute bottom-24 right-4 flex flex-col gap-6 text-white z-20">
        <div class="text-center"><i class="fas fa-heart text-3xl"></i><p class="text-xs">45K</p></div>
        <div class="text-center"><i class="fas fa-comment-dots text-3xl"></i><p class="text-xs">1.2K</p></div>
    </div>
</div>

<script>
    const videoList = ["VID_20251206_041026_071.mp4", "videos 22.mp4"];
    let currentIdx = 0;
    const videoElement = document.getElementById('mainVideo');
    let startY = 0;

    // ১. সোয়াইপ ও সাউন্ড কন্ট্রোল
    document.getElementById('swipeArea').addEventListener('touchstart', e => startY = e.touches[0].clientY);
    document.getElementById('swipeArea').addEventListener('touchend', e => {
        let endY = e.changedTouches[0].clientY;
        if (startY - endY > 50) { // Swipe Up
            currentIdx = (currentIdx + 1) % videoList.length;
            videoElement.src = videoList[currentIdx];
            videoElement.muted = false; // সাউন্ড সচল করার চেষ্টা
            videoElement.play();
        }
    });

    // ২. স্টোরি স্থায়ীভাবে সেভ করা (LocalStorage)
    function saveStory(base64Str) {
        let stories = JSON.parse(localStorage.getItem('myStories') || '[]');
        stories.push(base64Str);
        localStorage.setItem('myStories', JSON.stringify(stories));
        renderStories();
    }

    function renderStories() {
        let stories = JSON.parse(localStorage.getItem('myStories') || '[]');
        const list = document.getElementById('storyList');
        list.innerHTML = '';
        stories.forEach(src => {
            const div = document.createElement('div');
            div.className = 'story-circle';
            div.onclick = () => {
                document.getElementById('viewingImg').src = src;
                document.getElementById('storyViewer').style.display = 'flex';
            };
            div.innerHTML = `<img src="${src}">`;
            list.appendChild(div);
        });
    }

    function handleUpload(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = e => saveStory(e.target.result);
            reader.readAsDataURL(input.files[0]);
        }
    }

    // পেজ লোড হলে পুরোনো স্টোরি দেখানো
    window.onload = renderStories;

    // প্রথম ক্লিকে সাউন্ড চালু
    document.body.onclick = () => { videoElement.muted = false; videoElement.play(); };
</script>
</body>
</html>
